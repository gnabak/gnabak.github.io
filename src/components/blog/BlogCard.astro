---
import type { CollectionEntry } from 'astro:content';
import { getReadingTime } from '@/utils/getRelatedPosts';

interface Props {
	post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, pubDate, tags, image, imageAlt } = post.data;
const readingTime = getReadingTime(post.body);
---

<a href={`/blog/${post.slug}`} class="block group">
	<article class="border-l-[3px] border-purple pl-4 py-3 -ml-4 line-highlight flex gap-4 items-start">
		{image && (
			<img
				src={image}
				alt={imageAlt || title}
				class="w-16 h-16 rounded object-cover border border-border flex-shrink-0 mt-0.5"
			/>
		)}
		<div class="space-y-2 min-w-0">
			<h3 class="text-lg font-semibold group-hover:text-green transition-colors">
				<span class="font-mono text-comment text-sm mr-2">.md</span>{title}
			</h3>
			<p class="text-foreground/70 text-sm">
				{description}
			</p>
			<div class="flex items-center gap-3 font-mono text-xs text-comment">
				<span class="text-comment">//</span>
				<time datetime={pubDate.toISOString()}>
					{new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric', year: 'numeric' }).format(pubDate)}
				</time>
				<span class="text-cyan">{readingTime} min read</span>
				{tags && tags.length > 0 && (
					<span class="text-orange">{tags[0]}</span>
				)}
			</div>
		</div>
	</article>
</a>
