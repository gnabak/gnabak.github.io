---
import { getCollection } from 'astro:content';
import PageLayout from '@/layouts/PageLayout.astro';
import Badge from '@/components/ui/Badge.astro';
import { sortProjectsByOrder } from '@/utils/sortPosts';

const allProjects = await getCollection('projects');
const projects = sortProjectsByOrder(allProjects);
---

<PageLayout
	title="Projects"
	description="Things I've built."
>
	<div class="mb-12 space-y-2">
		<h1 class="font-display text-3xl font-bold sm:text-4xl text-gold">Projects</h1>
		<p class="text-comment">Things I've built.</p>
	</div>

	{projects.length > 0 ? (
		<div class="space-y-8">
			{projects.map((project) => (
				<a href={`/projects/${project.slug}`} class="block group">
					<article class="space-y-3">
						<h2 class="text-lg font-semibold group-hover:text-green transition-colors">
							{project.data.title}
						</h2>
						<p class="text-foreground/70 text-sm">
							{project.data.description}
						</p>
						{project.data.techStack && project.data.techStack.length > 0 && (
							<div class="flex flex-wrap gap-2">
								{project.data.techStack.map((tech) => (
									<Badge>{tech}</Badge>
								))}
							</div>
						)}
					</article>
				</a>
			))}
		</div>
	) : (
		<p class="text-comment">No projects yet.</p>
	)}
</PageLayout>
